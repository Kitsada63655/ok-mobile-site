<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡πÄ‡∏ä‡πá‡∏Ñ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ - OK Mobile</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
    }

    body {
      display: flex;
      flex-direction: column;
      font-family: 'Arial', sans-serif;
      background-color: #f0f8ff;
      color: #333;
    }

    header {
      background-color: #4caf50;
      color: white;
      padding: 10px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      position: relative;
    }

    header img {
      height: 40px;
      position: absolute;
      top: 10px;
      left: 10px;
    }

    .container {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .input-container {
      background-color: #ffffff;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.1);
      width: 90%;
      max-width: 500px;
      text-align: center;
    }

    input[type="text"] {
      padding: 15px;
      width: 100%;
      margin: 10px 0;
      border-radius: 5px;
      border: 2px solid #4caf50;
      font-size: 16px;
      outline: none;
    }

    input[type="text"]:focus {
      border-color: #2e7d32;
    }

    button, .back-button {
      padding: 12px 24px;
      margin-top: 15px;
      background-color: #4caf50;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s;
      text-decoration: none;
    }

    button:hover, .back-button:hover {
      background-color: #388e3c;
    }

    .result {
      margin-top: 20px;
      font-size: 18px;
      color: #333;
      text-align: center;
    }

    .result.success {
      color: #388e3c;
    }

    .result.error {
      color: #f44336;
    }

    .footer {
      background-color: #4caf50;
      color: white;
      text-align: center;
      padding: 15px 0;
      flex-shrink: 0;
    }
  </style>
</head>
<body>

  <header>
    <img src="https://i.imgur.com/nvYSgCM.jpeg" alt="OK Mobile Logo" />
    ‡πÄ‡∏ä‡πá‡∏Ñ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ - OK Mobile
  </header>

  <div class="container">
    <div class="input-container">
      <label for="serialNumber">‡πÄ‡∏ä‡πá‡∏Ñ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏≤‡∏Å‡∏£‡πâ‡∏≤‡∏ô‡πÇ‡∏≠‡πÄ‡∏Ñ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢ ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô !!üì±:</label>
      <input type="text" id="serialNumber" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç IMEI (‡∏Å‡∏î‡πÄ‡∏ä‡πá‡∏Ñ *#06#)">
      <button onclick="checkWarranty()">‡πÄ‡∏ä‡πá‡∏Ñ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô</button>
      <button onclick="scanBarcode()">‡∏™‡πÅ‡∏Å‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î</button>
      <a href="index.html" class="back-button">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
      <div id="result" class="result"></div>
    </div>
  </div>

  <div class="footer">
    ¬©OK-MOBILE2024 Ver.1.3 | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡πÇ‡∏ó‡∏£.094-6613961
  </div>

  <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° QuaggaJS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>

  <script>
    var history = [];

    function checkWarranty() {
      var serialNumber = document.getElementById("serialNumber").value;
      var apiKey = "AIzaSyBCtEQL9aVLIFMVnTdAXhRnz3vm__3eQ1M";  // ‡πÉ‡∏™‡πà API Key ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
      var spreadsheetId = "1Jaf3ifI-pJhDng9TQ0_0X4taa2rUfUscGBxocWW6s14";
      var range = "Sheet1!A2:F";
      var sheetURL = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?key=${apiKey}`;

      fetch(sheetURL)
        .then(response => response.json())
        .then(data => {
          var found = false;
          data.values.forEach(row => {
            var productSN = row[0];
            if (productSN === serialNumber) {
              found = true;
              var model = row[1];
              var price = row[2];
              var purchaseDate = row[3];
              var notes = row[4];

              document.getElementById("result").innerHTML = `
                <p><strong>‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏∏‡πà‡∏ô:</strong> ${model}</p>
                <p><strong>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢:</strong> ${price}</p>
                <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠:</strong> ${purchaseDate}</p>
                <p><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ${notes}</p>
              `;
              document.getElementById("result").classList.remove('error');
              document.getElementById("result").classList.add('success');
              
              // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
              history.push({serialNumber, model, price, purchaseDate, notes});
            }
          });

          if (!found) {
            document.getElementById("result").innerHTML = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ô‡∏µ‡πâ";
            document.getElementById("result").classList.remove('success');
            document.getElementById("result").classList.add('error');
          }
        })
        .catch(error => {
          console.error("Error fetching data: ", error);
          document.getElementById("result").innerHTML = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
          document.getElementById("result").classList.remove('success');
          document.getElementById("result").classList.add('error');
        });
    }

    function scanBarcode() {
      const existingReader = document.getElementById("barcode-reader");
      if (existingReader) existingReader.remove();

      const readerDiv = document.createElement("div");
      readerDiv.id = "barcode-reader";
      readerDiv.style = "width:100%;max-width:400px;margin:10px auto;";
      document.querySelector(".input-container").appendChild(readerDiv);

      Quagga.init({
        inputStream: {
          name: "Live",
          type: "LiveStream",
          target: readerDiv,
          constraints: {
            facingMode: "environment"
          }
        },
        decoder: {
          readers: ["code_128_reader", "ean_reader", "ean_8_reader", "upc_reader"]
        }
      }, function(err) {
        if (err) {
          console.error(err);
          alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ");
          readerDiv.remove();
          return;
        }
        Quagga.start();
      });

      Quagga.onDetected(result => {
        const code = result.codeResult.code;
        document.getElementById("serialNumber").value = code;
        Quagga.stop();
        document.getElementById("barcode-reader").remove();
      });
    }
  </script>

</body>
</html>
